{% extends "layout.html" %}

{% block content %}
<header class="page-header">
    <h1>Threat Intelligence Report</h1>
</header>
<div class="widget">
    <h3 class="widget-title">Detailed Threat Report (Last 100)</h3>
    <table class="cyber-table">
        <thead>
            <tr>
                <th>Timestamp</th>
                <th>Indicator</th>
                <th>Source</th>
                <th>Severity</th>
                <th>Country</th>
            </tr>
        </thead>
        <tbody>
            {% for threat in threats %}
            <tr>
                <td>{{ threat.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ threat.indicator }}</td>
                <td>{{ threat.source }}</td>
                <td><span style="font-weight: 600;">{{ threat.data.get('severity', 'low')|capitalize }}</span></td>
                <td>{{ threat.data.get('country', 'N/A') }}</td>
            </tr>
            {% else %}
            <tr><td colspan="5">No threat data found in the database.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}